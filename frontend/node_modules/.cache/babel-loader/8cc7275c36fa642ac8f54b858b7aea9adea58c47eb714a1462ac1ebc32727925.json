{"ast":null,"code":"import{useEffect,useRef,useState,useCallback}from'react';/**\r\n * useFullscreenMonitor\r\n * \r\n * Custom hook to monitor fullscreen status and detect violations.\r\n * Automatically enters fullscreen when enabled and tracks violations\r\n * like exiting fullscreen, tab switching, and window blur.\r\n * \r\n * @param {boolean} isEnabled - Whether monitoring is active\r\n * @param {function} onViolation - Callback when violation is detected\r\n * @param {object} student - Student object with rollNumber\r\n * @returns {object} - { enterFullscreen, exitFullscreen, isFullscreen, violationCount, showWarning, warningMessage }\r\n */export function useFullscreenMonitor(isEnabled,onViolation,student){const[isFullscreen,setIsFullscreen]=useState(false);const[violationCount,setViolationCount]=useState(0);const[showWarning,setShowWarning]=useState(false);const[warningMessage,setWarningMessage]=useState('');const lastViolationTime=useRef(0);const isMonitoring=useRef(false);// Enter fullscreen\nconst enterFullscreen=useCallback(async()=>{try{const elem=document.documentElement;if(elem.requestFullscreen){await elem.requestFullscreen();}else if(elem.webkitRequestFullscreen){await elem.webkitRequestFullscreen();}else if(elem.msRequestFullscreen){await elem.msRequestFullscreen();}}catch(err){console.error('Failed to enter fullscreen:',err);}},[]);// Exit fullscreen\nconst exitFullscreen=useCallback(async()=>{try{if(document.exitFullscreen){await document.exitFullscreen();}else if(document.webkitExitFullscreen){await document.webkitExitFullscreen();}else if(document.msExitFullscreen){await document.msExitFullscreen();}}catch(err){console.error('Failed to exit fullscreen:',err);}},[]);// Log violation to backend\nconst logViolation=useCallback(async violationType=>{if(!(student!==null&&student!==void 0&&student.rollNumber)||!onViolation)return;// Debounce violations (max 1 per 2 seconds)\nconst now=Date.now();if(now-lastViolationTime.current<2000)return;lastViolationTime.current=now;try{await onViolation(violationType);setViolationCount(prev=>prev+1);}catch(err){console.error('Failed to log violation:',err);}},[student,onViolation]);// Show warning message\nconst displayWarning=useCallback(message=>{setWarningMessage(message);setShowWarning(true);setTimeout(()=>setShowWarning(false),5000);// Hide after 5 seconds\n},[]);// Handle fullscreen change\nuseEffect(()=>{if(!isEnabled)return;const handleFullscreenChange=()=>{const isCurrentlyFullscreen=!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement);setIsFullscreen(isCurrentlyFullscreen);// If monitoring is active and user exited fullscreen\nif(isMonitoring.current&&!isCurrentlyFullscreen){logViolation('exit_fullscreen');displayWarning('⚠️ Warning: You have exited fullscreen.');// Re-enter fullscreen after a short delay\nsetTimeout(()=>enterFullscreen(),1000);}};document.addEventListener('fullscreenchange',handleFullscreenChange);document.addEventListener('webkitfullscreenchange',handleFullscreenChange);document.addEventListener('msfullscreenchange',handleFullscreenChange);return()=>{document.removeEventListener('fullscreenchange',handleFullscreenChange);document.removeEventListener('webkitfullscreenchange',handleFullscreenChange);document.removeEventListener('msfullscreenchange',handleFullscreenChange);};},[isEnabled,logViolation,displayWarning,enterFullscreen]);// Handle tab switching and window blur\nuseEffect(()=>{if(!isEnabled||!isMonitoring.current)return;const handleVisibilityChange=()=>{if(document.hidden){logViolation('tab_switch');displayWarning('⚠️ Warning: You switched tabs or minimized the window.');}};const handleWindowBlur=()=>{logViolation('window_blur');displayWarning('⚠️ Warning: You switched to another application.');};document.addEventListener('visibilitychange',handleVisibilityChange);window.addEventListener('blur',handleWindowBlur);return()=>{document.removeEventListener('visibilitychange',handleVisibilityChange);window.removeEventListener('blur',handleWindowBlur);};},[isEnabled,logViolation,displayWarning]);// Start monitoring\nconst startMonitoring=useCallback(()=>{isMonitoring.current=true;enterFullscreen();},[enterFullscreen]);// Stop monitoring\nconst stopMonitoring=useCallback(()=>{isMonitoring.current=false;exitFullscreen();},[exitFullscreen]);return{enterFullscreen,exitFullscreen,isFullscreen,violationCount,showWarning,warningMessage,startMonitoring,stopMonitoring};}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}